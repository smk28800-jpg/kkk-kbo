<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title> KKK KBO ì‹œë®¬ë ˆì´í„° </title>
<style>
:root{--brand:#ff5400;}
body{font-family:Arial,sans-serif;background:#f0f0f0;text-align:center;padding:20px;}
.container{width:600px;margin:auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.08);margin-bottom:20px;}
h2{color:var(--brand);margin-bottom:10px;border-bottom:2px solid var(--brand);padding-bottom:5px;}
button{background:var(--brand);color:#fff;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;margin-top:10px;font-weight:700;}
button:hover{background:#e05500;}
table{margin:0 auto;}
td{padding:6px 10px;}
input[type="text"]{padding:8px 10px;margin:6px;border-radius:8px;border:1px solid #ccc;width:250px;}
#seat-chart{display:grid;grid-template-columns:repeat(10,40px);gap:6px;margin-top:10px;}
.seat{width:40px;height:40px;background:#b0e57c;line-height:40px;border:1px solid #999;border-radius:8px;cursor:pointer;font-size:12px;user-select:none;}
.seat.selected{background:#f5a623;color:#111;font-weight:700;}
#selected-seats-display{margin-top:10px;font-weight:bold;}
#game-stage{position:relative;width:600px;height:320px;margin:16px auto 10px;border-radius:12px;overflow:hidden;border:1px solid #ddd;}
#hr-bg{position:absolute;inset:0;background-color:#f0f0f0;}
#hr-overlay{position:absolute;inset:0;background: radial-gradient(ellipse at 50% 60%, rgba(0,0,0,0) 20%, rgba(0,0,0,0.15) 70%);}
#ball{position:absolute;width:26px;height:26px;border-radius:50%;background:#fff;border:2px solid #222;box-shadow:0 2px 6px rgba(0,0,0,0.35);transform: translate(-50%, -50%);pointer-events:none;}
#bat{position:absolute;bottom:45px;right:65px;transform-origin:10% 90%;}
.swing{animation: swing 180ms ease-out forwards;}
@keyframes swing{0%{transform:rotate(0deg);}100%{transform:rotate(-55deg);}}
#contact-line{position:absolute;width:2px;height:100%;right:120px;top:0;pointer-events:none;}
</style>
</head>
<body>

<div class="container" id="game-screen">
  <h2>ê²½ê¸° ì„ íƒ</h2>
  <table>
    <tr><td>9ì›” 1ì¼</td><td><label><input type="radio" name="game" value="LG vs ë‘ì‚°"> LG vs ë‘ì‚°</label></td></tr>
    <tr><td>9ì›” 2ì¼</td><td><label><input type="radio" name="game" value="SSG vs ë¡¯ë°"> SSG vs ë¡¯ë°</label></td></tr>
    <tr><td>9ì›” 3ì¼</td><td><label><input type="radio" name="game" value="ê¸°ì•„ vs KT"> ê¸°ì•„ vs KT</label></td></tr>
    <tr><td>9ì›” 4ì¼</td><td><label><input type="radio" name="game" value="NC vs ì‚¼ì„±"> NC vs ì‚¼ì„±</label></td></tr>
  </table>
  <p>
    <label><input type="checkbox" id="medium-mode"> ì¤‘ìœ„í—˜ ëª¨ë“œ (CAPTCHA)</label>
    <label><input type="checkbox" id="high-mode"> ê³ ìœ„í—˜ ëª¨ë“œ (ë³¸ì¸ì¸ì¦)</label>
  </p>
  <button id="to-seat">ë‹¤ìŒ</button>
</div>

<div class="container" id="seat-screen" style="display:none">
  <h2>ì¢Œì„ ì„ íƒ</h2>
  <p>ì„ íƒí•œ ê²½ê¸°: <span id="selected-game-display"></span></p>
  <div id="seat-chart"></div>
  <div id="selected-seats-display">ì„ íƒëœ ì¢Œì„: ì—†ìŒ</div>
  <button id="to-auth">ë‹¤ìŒ</button>
</div>

<div class="container" id="home-run-screen" style="display:none">
  <div id="game-stage" aria-label="í™ˆëŸ° ê²Œì„ ì˜ì—­">
    <div id="hr-bg"></div>
    <div id="hr-overlay"></div>
    <div id="contact-line"></div>
    <div id="ball"></div>
    <svg id="bat" width="110" height="20">
      <rect x="0" y="0" width="110" height="20" rx="4" ry="4" fill="#8B4513"/>
    </svg>
  </div>
  <div id="game-msg" style="margin-top:10px; font-weight:bold;"></div>
  <div id="result" style="margin-top:8px; height:28px; font-weight:800;"></div>
  <button id="start-btn">ê²Œì„ ì‹œì‘</button>
  <button id="retry-btn" style="display:none">ë‹¤ì‹œ ì‹œë„</button>
</div>

<div class="container" id="captcha-screen" style="display:none">
  <h2>CAPTCHA ì¸ì¦</h2>
  <div id="captchaContainer">
    <span id="captchaText" style="font-size:20px; letter-spacing:3px;"></span><br>
    <input type="text" id="captchaInput" placeholder="CAPTCHA ì…ë ¥">
    <button id="captchaBtn">í™•ì¸</button>
  </div>
</div>

<div class="container" id="auth-screen" style="display:none">
  <h2>ë³¸ì¸ ì¸ì¦ (ì‹œë®¬ë ˆì´ì…˜)</h2>
  <div id="authContainer">
    <input type="text" id="nameInput" placeholder="ì´ë¦„"><br>
    <input type="text" id="phoneInput" placeholder="íœ´ëŒ€í° ë²ˆí˜¸"><br>
    <button id="sendCodeBtn">ì¸ì¦ë²ˆí˜¸ ì „ì†¡</button><br>
    <div id="simCodeContainer" style="display:none; margin-top:6px;">
      <input type="text" id="authCodeInput" placeholder="ì¸ì¦ë²ˆí˜¸ ì…ë ¥"><br>
      <span id="simCodeDisplay" style="color:gray; font-size:12px;"></span><br>
      <button id="authBtn">ì¸ì¦</button>
    </div>
  </div>
</div>

<div class="container" id="summary-screen" style="display:none">
  <h2>ì˜ˆë§¤ ì™„ë£Œ</h2>
  <p>ì„ íƒí•œ ê²½ê¸°: <span id="summary-game"></span></p>
  <p>ì„ íƒëœ ì¢Œì„: <span id="summary-seats"></span></p>
  <button id="restart">ì²˜ìŒìœ¼ë¡œ</button>
</div>

<script>
window.addEventListener('DOMContentLoaded', () => {
  let selectedGame="", selectedSeats=[], clickCount=0;

  function showScreen(id){
    ['game-screen','seat-screen','home-run-screen','captcha-screen','auth-screen','summary-screen']
      .forEach(s=>document.getElementById(s).style.display=(s===id?'block':'none'));
  }

  // ì²´í¬ë°•ìŠ¤ ë‹¨ì¼ ì„ íƒ
  const medium = document.getElementById('medium-mode');
  const high = document.getElementById('high-mode');
  medium.addEventListener('change', () => { if(medium.checked) high.checked = false; });
  high.addEventListener('change', () => { if(high.checked) medium.checked = false; });

  // ì¢Œì„ ìƒì„±
  const seatChart=document.getElementById('seat-chart');
  ['A','B','C','D','E'].forEach(row=>{
    for(let i=1;i<=10;i++){
      const seat=document.createElement('div');
      seat.className='seat';
      seat.textContent=row+i;
      seat.dataset.seat=row+i;
      seat.addEventListener('click', function(){
        const idx=selectedSeats.indexOf(this.dataset.seat);
        if(idx===-1){ selectedSeats.push(this.dataset.seat); this.classList.add('selected'); }
        else{ selectedSeats.splice(idx,1); this.classList.remove('selected'); }
        document.getElementById('selected-seats-display').textContent = selectedSeats.length>0 ? "ì„ íƒëœ ì¢Œì„: "+selectedSeats.join(', ') : "ì„ íƒëœ ì¢Œì„: ì—†ìŒ";
      });
      seatChart.appendChild(seat);
    }
  });

  // ê²½ê¸° ì„ íƒ -> ì¢Œì„
  document.getElementById('to-seat').addEventListener('click',()=>{
    const gameRadio=document.querySelector('input[name="game"]:checked');
    if(!gameRadio){ alert("ê²½ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
    selectedGame=gameRadio.value;
    document.getElementById('selected-game-display').textContent=selectedGame;
    selectedSeats=[]; clickCount=0;
    showScreen('seat-screen');
  });

  // ì¢Œì„ ì„ íƒ -> ì¸ì¦/ê²Œì„
  document.getElementById('to-auth').addEventListener('click',()=>{
    if(selectedSeats.length===0){ alert("ìµœì†Œ í•œ ê°œ ì¢Œì„ ì„ íƒ."); return; }
    if(high.checked){ showScreen('auth-screen'); }
    else if(medium.checked){ showCaptcha(); }
    else{ prepareHomeRunGame(); showScreen('home-run-screen'); }
  });

  // í™ˆëŸ° ê²Œì„
  const stage = document.getElementById('game-stage');
  const ball = document.getElementById('ball');
  const bat = document.getElementById('bat');
  const result = document.getElementById('result');
  const startBtn = document.getElementById('start-btn');
  const retryBtn = document.getElementById('retry-btn');
  const gameMsg = document.getElementById('game-msg');

  const totalTime = 3000;
  const minWin = 150;
  const maxWin = 650;
  let startTime, animId, zoneStartAt=null, gameOver=false, started=false;

  function prepareHomeRunGame(){
    cancelAnimationFrame(animId);
    ball.style.left = '120px'; ball.style.top = '70px'; ball.style.display = 'block';
    bat.style.transform = 'rotate(0deg)'; result.textContent = ''; gameMsg.textContent = 'ê³§ íˆ¬êµ¬ ì‹œì‘!';
    startBtn.style.display='inline-block'; retryBtn.style.display='none'; zoneStartAt=null; gameOver=false; started=false;
  }

  function swingBat(){ bat.classList.remove('swing'); void bat.offsetWidth; bat.classList.add('swing'); }
  function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

  function animate(ts){
    if(!startTime) startTime = ts;
    const elapsed = ts - startTime;
    const t = Math.min(elapsed / totalTime, 1);
    const e = easeOutCubic(t);
    const x0=120,x1=480,y0=70,y1=230,midLift=-40;
    const x=x0+(x1-x0)*e;
    const y=y0+(y1-y0)*e+(1-(2*Math.abs(0.5-e)))*midLift;
    ball.style.left = x+'px'; ball.style.top = y+'px';
    if(zoneStartAt===null && x >= 360) zoneStartAt = performance.now();
    if(elapsed<totalTime && !gameOver) animId=requestAnimationFrame(animate);
    else if(!gameOver){ result.textContent='í—›ìŠ¤ìœ™! ëŠ¦ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš” âš¾'; gameOver=true; startBtn.style.display='none'; retryBtn.style.display='inline-block'; }
  }

  stage.addEventListener('click', ()=>{
    if(!started || gameOver) return;
    swingBat();
    if(zoneStartAt===null) return;
    const reaction = performance.now() - zoneStartAt;
    if(reaction>=minWin && reaction<=maxWin){
      result.textContent='ì„±ê³µ! ì¸ì¦ ì™„ë£Œ ğŸ‰'; gameOver=true; cancelAnimationFrame(animId); setTimeout(()=>displaySummary(),500);
    }else{
      result.textContent=(reaction<minWin)?'í—›ìŠ¤ìœ™! ë„ˆë¬´ ë¹¨ëì–´ìš” ğŸ¥²':'í—›ìŠ¤ìœ™! ë„ˆë¬´ ëŠ¦ì—ˆì–´ìš” ğŸ¥²';
      gameOver=true; cancelAnimationFrame(animId); startBtn.style.display='none'; retryBtn.style.display='inline-block';
    }
  });

  startBtn.addEventListener('click', ()=>{
    if(started) return; started=true; gameOver=false; result.textContent=''; gameMsg.textContent='';
    startBtn.style.display='none'; retryBtn.style.display='none'; startTime=null; zoneStartAt=null;
    gameMsg.textContent = "ì ì‹œ í›„ íˆ¬êµ¬ê°€ ì‹œì‘ë©ë‹ˆë‹¤...";
    setTimeout(()=> animId=requestAnimationFrame(animate), 900);
  });

  retryBtn.addEventListener('click', prepareHomeRunGame);

  // CAPTCHA
  function showCaptcha(){
    const chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; let code=''; for(let i=0;i<5;i++) code+=chars.charAt(Math.floor(Math.random()*chars.length));
    window.captchaValue=code; document.getElementById('captchaText').innerText=code; document.getElementById('captchaInput').value='';
    showScreen('captcha-screen');
  }
  document.getElementById('captchaBtn').addEventListener('click',()=>{
    if(document.getElementById('captchaInput').value===window.captchaValue) displaySummary();
    else alert('CAPTCHAê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
  });

  // ì‹œë®¬ë ˆì´ì…˜ ë³¸ì¸ì¸ì¦
  document.getElementById('sendCodeBtn').addEventListener('click', ()=>{
    let name = document.getElementById('nameInput').value.trim();
    let phone = document.getElementById('phoneInput').value.trim();
    if(!name || !phone){ alert('ì´ë¦„ê³¼ íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
    const code = Math.floor(100000 + Math.random()*900000).toString();
    window.simAuthCode = code;
    document.getElementById('simCodeContainer').style.display = 'block';
    document.getElementById('simCodeDisplay').textContent = 'ì„ì‹œ ì¸ì¦ë²ˆí˜¸: ' + code;
  });

  document.getElementById('authBtn').addEventListener('click', ()=>{
    const inputCode = document.getElementById('authCodeInput').value.trim();
    if(inputCode === window.simAuthCode) displaySummary();
    else alert('ì¸ì¦ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
  });

  function displaySummary(){
    document.getElementById('summary-game').textContent = selectedGame;
    document.getElementById('summary-seats').textContent = selectedSeats.join(', ');
    showScreen('summary-screen');
  }

  document.getElementById('restart').addEventListener('click',()=>{ showScreen('game-screen'); });
});
</script>

</body>
</html>
